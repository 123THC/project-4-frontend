<!DOCTYPE html>

<img class="showPagePicture" ng-src="{{ jobsShow.job.image_src }}">

<div class="container">
  <div class="row">
    <div class="col-md-12 col-xs-12 summaryBox">
      <div class="categoryDisplay">
        <ul>
          <li class="categoryShowPage" ng-repeat="category in jobsShow.job.categories">{{ category.name }}<img ng-src="{{ category.image }}"></li>
        </ul><hr>
      </div>
      <div>
        <p>Description: {{jobsShow.job.description }}</p><hr>
        <p>Pay: {{ jobsShow.job.hourly_rate | currency: 'Â£' }} p/h</p><hr>
        <p>Job Posted By: <a ui-sref="usersShow({ id: jobsShow.job.postedById })">{{ jobsShow.job.postedBy }}</a></p><hr>
        <p>Date: {{ jobsShow.job.date }}</p><hr>
      </div>
    </div>
  </div>

  <div ng-if="main.currentUser.id != jobsShow.job.postedById">
    <button class="btn btn-primary" ng-click="jobsShow.toggleApplied()" ng-if="!jobsShow.hasApplied() && main.isAuthenticated()">Apply For Job</button>
    <button class="btn btn-danger" ng-click="jobsShow.toggleApplied()" ng-if="jobsShow.hasApplied() && main.isAuthenticated()">Withdraw Application</button>
  </div>

  <div class="comments">
    <div class="row">
      <div class="col-md-6">
        <h4>Comments</h4>
        <ul>
          <li ng-repeat="comment in jobsShow.job.comments">{{ comment.body }} - <strong>{{ comment.user.username }}</strong><button ng-click="jobsShow.deleteComment(comment)" ng-if="main.isAuthenticated() && main.currentUser.id === comment.user.id">Delete</button></li>
        </ul>
      </div>
      <div class="col-md-6" ng-if="main.isAuthenticated()">
        <h4>Add Comment</h4>
        <form ng-submit="jobsShow.addComment()">
          <textarea type="text" name="body" ng-model="jobsShow.comment.body"></textarea>
          <button>Create</button>
        </form>
      </div>
    </div>
  </div>

  <div class="row container">
    <div class="ownersViewShowPage col-xs-12">
      <div ng-if="main.currentUser.id == jobsShow.job.postedById">
        <h4>Current Applicant Pool</h4>
        <ul>
          <li ng-repeat="applicant in jobsShow.job.applicants"><a ui-sref="usersShow({ id: applicant.id })" class="profileViewPool"><img ng-src="{{ applicant.image_src }}">{{ applicant.username }}</a>
          <button ui-sref="applicantSelection({ id: jobsShow.job.id, userid: applicant.id })" class="btn btn-primary">Accept {{applicant.username }}</button></li>
        </ul>
      </div>

      <div ng-if="main.currentUser.id == jobsShow.job.postedById">
        <a ui-sref="jobsEdit({ id: jobsShow.job.id })" class="btn btn-primary">Edit Job</a><br>
        <button ng-click="jobsShow.delete()" class="btn btn-danger">Delete Job</button>
      </div>
    </div>
  </div>
</div>
